import org.apache.tools.ant.filters.ReplaceTokens

plugins {
    id 'com.github.johnrengelman.shadow' version '7.0.0'
    id 'java'
}

group 'fr.ostracraft.towns'
version '1.0'

def mcVersion = '1.16'
def subVersion = '.5'

repositories {
    mavenCentral()
    maven { url = 'https://hub.spigotmc.org/nexus/content/repositories/snapshots/' }
    maven { url 'https://jitpack.io' }
}

dependencies {
    shadow group: 'org.jetbrains', name: 'annotations', version: '21.0.1'
    shadow group: 'org.spigotmc', name: 'spigot-api', version: mcVersion + subVersion + '-R0.1-SNAPSHOT'
    implementation group: 'com.zaxxer', name: 'HikariCP', version: '4.0.3'
    implementation group: 'com.github.BakaAless', name: 'CommandAPI', version: '868807870', {
        exclude module: 'spigot-api'
        exclude module: 'annotations'
    }
}

shadowJar {
    archiveName 'OstraTowns.jar'
    setLibsDirName '..\\out'
    relocate 'com.zaxxer.hikari', 'fr.ostracraft.towns.libs.hikari'
    relocate 'fr.bakaaless.api', 'fr.ostracraft.towns.libs.commandapi'
}
[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

processResources {
    filter ReplaceTokens, tokens: [
            'version': project.property('version'),
            'apiVersion': mcVersion,
    ]
}